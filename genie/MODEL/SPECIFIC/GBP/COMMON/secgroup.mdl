module[gbp]
{
    class[SecGroup;
          super=gbp/AccessBehavioralGroup;
          concrete]
    {
        contained
        {
            parent[class=policy/Space]
        }
        named
        {
            parent[class=*;]
            {
                component[prefix=secgroup;
                          member=name]
            }
        }
    }

    class[SecGroupSubject;
          super=gbp/AccessBehavioralGroup;
          concrete]
    {
        contained
        {
            parent[class=gbp/SecGroup]
        }
        named
        {
            parent[class=*;]
            {
                component[prefix=subject;
                          member=name]
            }
        }
    }

    # DNS FQDN or Regex(only leading *)
    class[DnsName;
          super=policy/NamedDefinition;
          concrete]
    {
        contained
        {
            parent[class=gbp/SecGroupRule]
        }
        named
        {
            parent[class=*;]
            {
                component[member=name]
            }
        }
    }

    class[SecGroupRule;
          super=gbp/Rule;
          concrete]
    {
        contained
        {
            parent[class=gbp/SecGroupSubject]
        }

        # Set of remote prefixes to which this rule applies.
        dependency[remoteAddress;
                   cardinality=many;
                   ]
        {
            to[class=gbp/Subnets;
                cardinality=many;
                ]
        }
    }
}
